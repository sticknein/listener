(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{108:function(e,t,n){},109:function(e,t,n){},110:function(e,t,n){},111:function(e,t,n){},112:function(e,t,n){},113:function(e,t,n){},114:function(e,t,n){},115:function(e,t,n){},118:function(e,t,n){},119:function(e,t,n){},120:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n.n(c),s=n(17),o=n.n(s),i=n(3),r=n(24),l=n(5),u=(n(66),n(67),n(138)),j=n(1);var d=function(e){var t=Object(c.useState)(null),n=Object(i.a)(t,2),a=n[0],s=n[1],o=Object(c.useState)("I'm a bio! Weeeeeee!"),r=Object(i.a)(o,2),l=r[0],d=r[1],b=Object(c.useState)(e.user.display_name),m=Object(i.a)(b,2),h=m[0],O=m[1],p=Object(c.useState)(e.user.username),f=Object(i.a)(p,2),x=f[0],g=f[1];return Object(j.jsxs)("div",{className:"edit-account",children:[Object(j.jsx)("h1",{children:"Edit Account"}),Object(j.jsxs)("form",{onSubmit:function(t){return function(t){var n={avatar:e.user.avatar,bio:l,date_joined:e.user.date_joined,display_name:h,email:e.user.email,has_account:!0,last_online:e.user.last_online,tokens:e.user.tokens,username:x};if(a){var c=new FormData;c.append("file",a),t.preventDefault(),fetch("/upload-avatar",{method:"POST",body:c}).then((function(e){return e.json()})).then((function(e){n.avatar=e;var c=JSON.stringify(n);t.preventDefault(),fetch("/edit-user",{method:"POST",headers:{"Content-Type":"application/json"},body:c}).then((function(){return console.log("Edited user @".concat(x)),localStorage.setItem("user",c),window.location.assign("/")})).catch((function(e){return console.log(e)}))})).catch((function(e){return console.log(e)}))}else{var s=JSON.stringify(n);t.preventDefault(),fetch("/edit-user",{method:"POST",body:s}).then((function(){return console.log("Edited user @".concat(x)),localStorage.setItem("user",s),window.location.assign("/")})).catch((function(e){return console.log(e)}))}}(t)},children:[Object(j.jsx)("input",{onChange:function(e){return g(e.target.value)},value:x,placeholder:e.user.username,type:"text",maxLength:"15",className:"input"}),Object(j.jsx)("p",{children:"Please select your username. For example, paulmccartney."}),Object(j.jsx)("input",{onChange:function(e){return O(e.target.value)},value:h,placeholder:e.user.display_name,type:"text",maxLength:"50",className:"input"}),Object(j.jsx)("p",{children:"Please select your display name. For example, Paul McCartney."}),Object(j.jsx)("textarea",{onChange:function(e){return d(e.target.value)},value:l,placeholder:"I'm a bio! Weeeeeee!",type:"text",maxLength:"160",className:"bio"}),Object(j.jsx)("p",{children:'Tell us about yourself. For example, "I am the walrus."'}),Object(j.jsx)("input",{onChange:function(e){!function(e){var t=new FileReader,n=e.target.files[0];n?(t.onload=function(){2===t.readyState&&s(n)},t.readAsDataURL(e.target.files[0])):s(null)}(e)},type:"file",id:"avatar",name:"avatar",accept:".png, .jpg, .jpeg",encType:"multipart/form-data"}),Object(j.jsx)("p",{children:"Upload a profile picture (jpeg or png)"}),Object(j.jsx)(u.a,{id:"loginButton",type:"submit",children:"Create Account"})]})]})},b=(n(72),n(20)),m=(n(73),n(139));var h=function(e){var t=Object(c.useState)(""),n=Object(i.a)(t,2),a=n[0],s=n[1],o=Object(c.useState)(""),r=Object(i.a)(o,2),l=r[0],d=r[1];return Object(j.jsx)("div",{className:"postBox",children:Object(j.jsxs)("form",{children:[Object(j.jsxs)("div",{className:"postBox-input",children:[Object(j.jsx)(m.a,{src:e.user.avatar}),Object(j.jsx)("textarea",{onChange:function(e){return s(e.target.value)},placeholder:"What are you listening to?",type:"text",value:a})]}),Object(j.jsx)(u.a,{className:"post-button",onClick:function(){var t={user:e.user,text:a,link:l};fetch("/send-post",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(){e.getUserPosts()})).catch((function(e){return console.log("Error: ",e)})),s(""),d("")},type:"submit",children:"Post"})]})})},O=n(28),p=n.n(O),f=(n(74),n(75),n(37)),x=n.n(f),g=n(36),v=n.n(g),y=n(26),N=n.n(y),S=n(48);p.a.extend(S);var _=function(e){var t=Object(c.useState)(!1),n=Object(i.a)(t,2),a=n[0],s=n[1],o=Object(c.useState)(e.liked_by.length),r=Object(i.a)(o,2),l=r[0],d=r[1],b=Object(c.useState)(!1),h=Object(i.a)(b,2),O=h[0],f=h[1];Object(c.useEffect)((function(){e.liked_by.includes(e.active_user.email)&&s(!0)}));var g=function(){a?(d(l-1),s(!1),fetch("/unlike-comment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({comment_id:e.comment_id,email:e.active_user.email})})):(d(l+1),s(!0),fetch("/like-comment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({comment_id:e.comment_id,email:e.active_user.email})}).catch((function(e){return console.log(e)})))},y=function(){f(!O)};return console.log("active_user",e),Object(j.jsxs)("div",{className:"comment",children:[Object(j.jsxs)("header",{className:"comment-header",children:[Object(j.jsx)(m.a,{className:"comment-avatar",src:e.user.avatar}),Object(j.jsxs)("div",{className:"comment-header-text",children:[Object(j.jsx)("h3",{className:"comment-display-name",children:e.user.display_name}),Object(j.jsxs)("h4",{className:"comment-username",children:["@",e.user.username]}),Object(j.jsx)("h4",{children:" \u2022 "}),Object(j.jsx)("h5",{id:"comment-timestamp",children:p()(e.timestamp).fromNow()})]}),Object(j.jsx)("div",{className:"delete-comment",children:e.user.username===e.active_user.username&&Object(j.jsx)(N.a,{id:"comment-options",onClick:y})}),O?Object(j.jsx)(u.a,{className:"delete-comment-button",onClick:function(){fetch("/delete-comment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({comment_id:e.comment_id,post_id:e.post_id})}).then((function(){console.log("Deleted comment ".concat(e.comment_id)),y(),e.getPostComments()})).catch((function(e){console.log(e)}))},children:"Delete"}):null]}),Object(j.jsx)("div",{className:"comment-text",children:Object(j.jsx)("p",{children:e.text})}),Object(j.jsx)("footer",{className:"comment-footer",children:a?Object(j.jsxs)("div",{id:"likes",children:[Object(j.jsx)(v.a,{id:"liked",fontSize:"small",onClick:g}),l>0?Object(j.jsx)("p",{id:"like-count",children:l}):null]}):Object(j.jsxs)("div",{id:"likes",children:[Object(j.jsx)(x.a,{id:"like",fontSize:"small",onClick:g}),l>0?Object(j.jsx)("p",{id:"like-count",children:l}):null]})})]})},k=n(57),C=n.n(k),w=(n(77),n(48));p.a.extend(w);var T=function(e){var t=Object(c.useState)(!1),n=Object(i.a)(t,2),a=n[0],s=n[1],o=Object(c.useState)(e.liked_by.length),r=Object(i.a)(o,2),l=r[0],d=r[1],h=Object(c.useState)(!0),O=Object(i.a)(h,2),f=O[0],g=O[1],y=Object(c.useState)(0),S=Object(i.a)(y,2),k=S[0],w=S[1],T=Object(c.useState)(""),P=Object(i.a)(T,2),L=P[0],D=P[1],J=Object(c.useState)([]),E=Object(i.a)(J,2),I=E[0],U=E[1],F=Object(c.useState)(!1),A=Object(i.a)(F,2),W=A[0],z=A[1];Object(c.useEffect)((function(){e.liked_by.includes(e.active_user.email)&&s(!0),0===k&&w(e.comments),document.addEventListener("keydown",(function(e){27===e.keyCode&&(g(!0),U([]))}))}));var R=function(){a?(d(l-1),s(!1),fetch("/unlike-post",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({post_id:e.post_id,email:e.active_user.email})})):(d(l+1),s(!0),fetch("/like-post",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({post_id:e.post_id,email:e.active_user.email})}).catch((function(e){return console.log(e)})))},B=function(){fetch("/get-post-comments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({post_id:e.post_id})}).then((function(e){return e.json()})).then((function(e){return w(e.length),U(e)})).catch((function(e){return console.log(e)}))},H=function(){z(!W)},M=function(){window.location.assign("/u/".concat(e.user.username))};return Object(j.jsxs)("div",{className:"post",children:[Object(j.jsxs)("header",{className:"post-header",children:[Object(j.jsx)(m.a,{className:"post-avatar",src:e.user.avatar,onClick:M}),Object(j.jsxs)("div",{className:"post-header-text",children:[Object(j.jsx)("h3",{className:"post-display-name",onClick:M,children:e.user.display_name}),Object(j.jsxs)("h4",{className:"post-username",onClick:M,children:["@",e.user.username]}),Object(j.jsx)("h4",{children:" \u2022 "}),Object(j.jsx)("h5",{id:"timestamp",children:p()(e.timestamp).fromNow()})]}),Object(j.jsx)("div",{className:"delete",children:e.user.username===e.active_user.username&&Object(j.jsx)(N.a,{id:"post-options",onClick:H})}),W?Object(j.jsx)("div",{id:"delete-post",children:Object(j.jsx)(u.a,{className:"delete-post-button",onClick:function(){fetch("/delete-post",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({post_id:e.post_id})}).then((function(){console.log("Deleted post ".concat(e.post_id)),H(),e.getUserPosts()})).catch((function(e){console.log(e)}))},children:"Delete Post"})}):null]}),Object(j.jsx)("div",{className:"post-text",children:Object(j.jsx)("p",{children:e.text})}),Object(j.jsxs)("div",{className:"post-footer",children:[a?Object(j.jsxs)("div",{id:"likes",children:[Object(j.jsx)(v.a,{id:"liked",fontSize:"small",onClick:R}),l>0?Object(j.jsx)("p",{id:"like-count",children:l}):null]}):Object(j.jsxs)("div",{id:"likes",children:[Object(j.jsx)(x.a,{id:"like",fontSize:"small",onClick:R}),l>0?Object(j.jsx)("p",{id:"like-count",children:l}):null]}),Object(j.jsx)(C.a,{id:"comment-icon",fontSize:"small",onClick:function(){f?(g(!1),e.comments>0&&B()):(U([]),g(!0))}}),k>0?Object(j.jsx)("div",{classname:"comments-count",children:k}):null,f?null:Object(j.jsxs)("div",{className:"comment-box",children:[Object(j.jsx)(m.a,{id:"avatar",src:e.active_user.avatar}),Object(j.jsx)("textarea",{autoFocus:!0,className:"comment-input",onChange:function(e){return D(e.target.value)},placeholder:"Comment...",value:L}),Object(j.jsx)(u.a,{className:"comment-button",onClick:function(){var t={post_id:e.post_id,user:e.active_user,text:L};fetch("/send-comment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(e){var t=I.slice();t.unshift(e),w(k+1),U(t),D("")})).catch((function(e){return console.log(e)})),D("")},type:"submit",children:"Comment"})]})]}),I.length>0?Object(j.jsx)(b.a,{children:Object(j.jsx)("div",{className:"comments",children:I.map((function(t){return Object(j.jsx)("div",{className:"comment",children:Object(j.jsx)(_,{active_user:e.active_user,comment_id:t.comment_id,comments:t.comments,getPostComments:B,post_id:t.post_id,liked_by:t.liked_by,text:t.text,timestamp:t.timestamp,user:t.user})},t.comment_id)}))})}):null]})};var P=function(e){var t=Object(c.useState)(null),n=Object(i.a)(t,2),a=n[0],s=n[1],o=Object(c.useState)(!0),r=Object(i.a)(o,2),l=(r[0],r[1],Object(c.useState)(null)),u=Object(i.a)(l,2),d=(u[0],u[1],function(){fetch("/get-posts").then((function(e){return e.json()})).then((function(e){var t=[];return e.forEach((function(e){if(e.comments>0)for(var n=0;n<e.comments;n++)t.push(e.comments[n])})),s(e)})).catch((function(e){return console.log(e)}))});return Object(c.useEffect)((function(){a||d()})),Object(j.jsxs)("div",{className:"feed",children:[Object(j.jsx)("div",{className:"feed-header",children:Object(j.jsxs)("h2",{children:["Welcome to listener, ",e.user.display_name,"."]})}),Object(j.jsx)(h,{user:e.user,getUserPosts:d}),!a&&Object(j.jsx)("h3",{className:"no-posts",children:"No posts yet!"}),a&&Object(j.jsx)(b.a,{children:Object(j.jsx)("div",{className:"posts",children:a.map((function(t){return Object(j.jsx)("div",{className:"post",children:Object(j.jsx)(T,{active_user:e.user,comments:t.comments,post_id:t.post_id,getUserPosts:d,liked_by:t.liked_by,link:t.link,text:t.text,timestamp:t.timestamp,user:t.user})},t.post_id)}))})})]})};n(108);var L=function(){return Object(j.jsx)("div",{className:"loading",children:Object(j.jsx)("h1",{children:"Loading..."})})};n(109);var D=function(e){return Object(j.jsx)("div",{id:"login",children:Object(j.jsx)("div",{id:"login-container",children:Object(j.jsxs)("div",{className:"login-sub-container",children:[Object(j.jsx)("h1",{children:"Welcome to listener"}),Object(j.jsx)("h2",{children:"Please login using your Spotify account"}),Object(j.jsx)(u.a,{id:"login-button",onClick:function(e){fetch("/authorize").then((function(e){return e.json()})).then((function(e){window.location.assign(e)})).catch((function(e){return console.log(e)}))},children:"Login"}),Object(j.jsxs)("div",{className:"email-login",children:[Object(j.jsx)("p",{children:"Don't have a Spotify account?  "}),Object(j.jsx)(u.a,{id:"email-password-login-button",onClick:function(t){return e.emailLogin()},children:"Login Here"})]})]})})})};n(110);var J=function(e){return Object(j.jsxs)("div",{className:"logout",children:[Object(j.jsx)("h1",{className:"logout-header",children:"Are you sure you'd like to logout?"}),Object(j.jsxs)("div",{className:"buttons",children:[Object(j.jsx)(u.a,{className:"logout-button",id:"logout-cancel-button",onClick:function(){window.location="/"},children:"Cancel"}),Object(j.jsx)(u.a,{className:"logout-button",onClick:function(){e.logout()},children:"Confirm"})]})]})};n(111),n(112);var E=function(e){return Object(j.jsxs)("div",{className:"user-now-playing",children:[Object(j.jsxs)("div",{className:"user-now-playing-header",children:[Object(j.jsx)(m.a,{className:"now-playing-avatar",src:e.user_playback.user.avatar}),Object(j.jsxs)("p",{className:"now-playing-username",children:["@",e.user_playback.user.username]})]}),Object(j.jsxs)("div",{className:"user-track",children:[Object(j.jsx)("a",{className:"now-playing-track",href:e.user_playback.playback.external_urls.spotify,target:"_blank",children:e.user_playback.playback.name}),Object(j.jsx)("p",{children:"by"}),Object(j.jsx)("a",{className:"now-playing-artist",href:e.user_playback.playback.artists[0].external_urls.spotify,target:"_blank",children:e.user_playback.playback.artists[0].name}),Object(j.jsx)("p",{children:"from"}),Object(j.jsx)("a",{className:"now-playing-album",href:e.user_playback.playback.album.external_urls.spotify,target:"_blank",children:e.user_playback.playback.album.name})]})]})};var I=function(e){var t=Object(c.useState)(null),n=Object(i.a)(t,2),a=n[0],s=n[1];return Object(c.useEffect)((function(){fetch("/now-playing").then((function(e){return e.json()})).then((function(e){e&&s(e)})).catch((function(e){return console.log(e)}))}),[]),Object(j.jsxs)("div",{className:"playback-feed-container",children:[Object(j.jsx)("h2",{children:"Now Playing"}),Object(j.jsx)("br",{}),a&&Object(j.jsx)(b.a,{children:Object(j.jsx)("div",{className:"playback-feed",children:a.map((function(e){return Object(j.jsx)("div",{className:"user-playback",children:Object(j.jsx)(E,{user_playback:e})})}))})}),Object(j.jsx)("br",{})]})};n(113);var U=function(e){var t=Object(c.useState)(null),n=Object(i.a)(t,2),a=n[0],s=n[1],o=Object(c.useState)(!0),r=Object(i.a)(o,2),l=r[0];return r[1],Object(c.useEffect)((function(){a||fetch("/get-user-posts").then((function(e){return e.json()})).then((function(e){var t=[];return e.forEach((function(e){if(e.comments>0)for(var n=0;n<e.comments;n++)t.push(e.comments[n])})),s(e)})).catch((function(e){return console.log(e)}))})),Object(j.jsxs)("div",{className:"profile",children:[Object(j.jsxs)("div",{className:"sub-header",children:[Object(j.jsx)("div",{id:"prof-pic-row",children:Object(j.jsx)("img",{src:e.user.avatar,id:"prof-pic",alt:"Profile picture"})}),Object(j.jsxs)("div",{id:"name-row",children:[Object(j.jsx)("h1",{children:e.user.display_name}),Object(j.jsxs)("h2",{children:["@",e.user.username]}),Object(j.jsx)("p",{className:"bio",children:e.user.bio})]})]}),Object(j.jsx)("hr",{}),a&&Object(j.jsx)(b.a,{children:Object(j.jsx)("div",{className:"posts",children:a.map((function(t){return Object(j.jsxs)("div",{className:"post",children:[Object(j.jsx)(T,{active_user:e.user,comments:t.comments,post_id:t.post_id,liked_by:t.liked_by,link:t.link,text:t.text,timestamp:t.timestamp,user:t.user}),l?null:Object(j.jsx)("div",{className:"comments"})]},t.post_id)}))})})]})};n(114),n(115);var F=function(e){var t=e.active,n=e.text,c=e.Icon;return Object(j.jsxs)("div",{className:"sidebarOption ".concat(t&&"sidebarOption--active"),children:[Object(j.jsx)(c,{}),Object(j.jsx)("h2",{children:n})]})},A=n(58),W=n.n(A),z=n(44),R=n.n(z),B=n(59),H=n.n(B);var M=function(e){return Object(j.jsxs)("div",{className:"sidebar",children:[Object(j.jsx)(R.a,{className:"sidebar-listenerIcon"}),Object(j.jsx)(r.b,{to:"/",style:{textDecoration:"none"},children:Object(j.jsx)(F,{Icon:W.a,text:"Home"})}),Object(j.jsx)(r.b,{to:"/u/".concat(e.user.username),style:{textDecoration:"none"},children:Object(j.jsx)(F,{Icon:H.a,text:"Profile"})}),Object(j.jsx)(r.b,{to:"/logout",style:{textDecoration:"none"},children:Object(j.jsx)(F,{Icon:N.a,text:"Logout"})})]})};n(118);var Y=function(e){var t=Object(c.useState)(null),n=Object(i.a)(t,2),a=n[0],s=n[1],o=Object(c.useState)("I'm a bio! Weeeeeee!"),r=Object(i.a)(o,2),l=r[0],d=r[1],b=Object(c.useState)(""),m=Object(i.a)(b,2),h=m[0],O=m[1],p=Object(c.useState)(""),f=Object(i.a)(p,2),x=f[0],g=f[1],v=Object(c.useState)(""),y=Object(i.a)(v,2),N=y[0],S=y[1],_=Object(c.useState)(""),k=Object(i.a)(_,2),C=k[0],w=k[1],T=Object(c.useState)(""),P=Object(i.a)(T,2),L=P[0],D=P[1];return Object(j.jsx)("div",{className:"email-password-setup",children:Object(j.jsx)("div",{className:"email-password-container",children:Object(j.jsxs)("div",{className:"email-form",children:[Object(j.jsx)("h1",{children:"Create Account"}),Object(j.jsxs)("form",{onSubmit:function(e){return function(e){var t={avatar:"",bio:l,date_joined:(new Date).toString(),display_name:h,email:x,password:N,has_account:!0,last_online:(new Date).toString(),tokens:{},username:L};if(N===C){if(a){var n=new FormData;n.append("file",a);var c=JSON.stringify(t);return e.preventDefault(),fetch("/create-user",{method:"POST",headers:{"Content-Type":"application/json"},body:c}).then((function(){return fetch("/upload-avatar",{method:"POST",body:n}).then((function(e){return e.json()})).then((function(n){t.avatar=n;var c=JSON.stringify(t);return e.preventDefault(),fetch("/edit-user",{method:"POST",headers:{"Content-Type":"application/json"},body:c}).then((function(){console.log("User created!"),localStorage.setItem("user",c),window.location.assign("/")})).catch((function(e){return console.log(e)}))})).catch((function(e){return console.log(e)}))}))}var s=JSON.stringify(t);return e.preventDefault(),fetch("create-user",{method:"POST",headers:{"Content-Type":"application/json"},body:s}).then((function(){console.log("User created!"),localStorage.setItem("user",s),window.location.assign("/")})).catch((function(e){return console.log(e)}))}e.preventDefault(),window.alert("Ruh roh! The passwords don't match!")}(e)},children:[Object(j.jsx)("input",{onChange:function(e){return g(e.target.value)},value:x,placeholder:"email",type:"text",maxLength:"320",className:"input"}),Object(j.jsx)("br",{}),Object(j.jsx)("br",{}),Object(j.jsx)("input",{onChange:function(e){return S(e.target.value)},value:N,placeholder:"password",type:"password",maxLength:"64",className:"input"}),Object(j.jsx)("br",{}),Object(j.jsx)("br",{}),Object(j.jsx)("input",{onChange:function(e){return w(e.target.value)},value:C,placeholder:"Confirm Password",type:"password",maxLength:"64",className:"input"}),Object(j.jsx)("br",{}),Object(j.jsx)("br",{}),Object(j.jsx)("input",{onChange:function(e){return D(e.target.value)},value:L,placeholder:"username",type:"text",maxLength:"15",className:"input"}),Object(j.jsx)("br",{}),Object(j.jsx)("br",{}),Object(j.jsx)("input",{onChange:function(e){return O(e.target.value)},value:h,type:"text",placeholder:"Your Name",maxLength:"50",className:"input"}),Object(j.jsx)("br",{}),Object(j.jsx)("br",{}),Object(j.jsx)("textarea",{onChange:function(e){return d(e.target.value)},value:l,placeholder:"I'm a bio! Weeeeeee!",type:"text",maxLength:"160",className:"bio"}),Object(j.jsx)("br",{}),Object(j.jsx)("br",{}),Object(j.jsx)("input",{onChange:function(e){!function(e){var t=new FileReader,n=e.target.files[0];n?(t.onload=function(){2===t.readyState&&s(n)},t.readAsDataURL(e.target.files[0])):s(null)}(e)},type:"file",id:"avatar",name:"avatar",accept:".png, .jpg, .jpeg",encType:"multipart/form-data"}),Object(j.jsx)("p",{children:"Upload a profile picture (jpeg or png)"}),Object(j.jsx)(u.a,{id:"email-login-cancel-button",onClick:function(){e.cancelEmailLogin()},children:"Cancel"}),Object(j.jsx)(u.a,{id:"email-login-button",type:"submit",children:"Create Account"})]})]})})})};n(119);var q=function(e){var t=Object(c.useState)(""),n=Object(i.a)(t,2),a=n[0],s=n[1],o=Object(c.useState)(""),r=Object(i.a)(o,2),l=r[0],d=r[1],b=function(t){var n=JSON.stringify({email:a,password:l});return fetch("/email-password-login",{method:"POST",headers:{"Content-Type":"application/json"},body:n}).then((function(e){return e.json()})).then((function(t){!0===t?e.loginUser(a):window.alert("Password incorrect")}))};return Object(j.jsx)("div",{className:"email-password-login",children:Object(j.jsxs)("div",{className:"email-login-container",children:[Object(j.jsx)("h1",{children:"Login"}),Object(j.jsxs)("form",{onSubmit:function(e){return b()},children:[Object(j.jsx)("input",{onChange:function(e){return s(e.target.value)},value:a,placeholder:"Email",type:"text",maxLength:320,className:"input"}),Object(j.jsx)("br",{}),Object(j.jsx)("br",{}),Object(j.jsx)("input",{onChange:function(e){return d(e.target.value)},value:l,placeholder:"Password",type:"password",maxLength:64,className:"input"}),Object(j.jsxs)("div",{className:"button-box",children:[Object(j.jsx)(u.a,{id:"email-login-cancel-button",onClick:function(){e.cancelEmailLogin()},children:"Cancel"}),Object(j.jsx)(u.a,{id:"email-login-button",onClick:b,children:"Login"})]}),Object(j.jsx)("p",{children:"Don't have an account?"}),Object(j.jsx)(u.a,{id:"email-password-setup-button",onClick:function(){e.setupEmailLogin()},children:"Click Here"})]})]})})};var G=function(e){var t=Object(c.useState)(!1),n=Object(i.a)(t,2),a=n[0],s=n[1],o=Object(c.useState)(!0),u=Object(i.a)(o,2),b=u[0],m=u[1],h=Object(c.useState)(!1),O=Object(i.a)(h,2),p=O[0],f=O[1],x=Object(c.useState)(!0),g=Object(i.a)(x,2),v=g[0],y=g[1],N=Object(c.useState)(null),S=Object(i.a)(N,2),_=S[0],k=S[1];Object(c.useEffect)((function(){var e=localStorage.getItem("user"),t=JSON.parse(e);_||e?!_&&e&&fetch("/set-user",{method:"POST",headers:{"Content-Type":"application/json"},body:e}).then((function(){k(t),f(!0),y(!1)})).catch((function(e){return console.log(e)})):fetch("/check-user").then((function(e){return e.json()})).then((function(e){null!==e?(localStorage.setItem("user",JSON.stringify(e)),k(e),f(!0),y(!1)):(f(!1),y(!1))})).catch((function(e){return console.log(e)}))}),[]);var C=function(){s(!1),m(!0),f(!1)},w=function(){fetch("/logout",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}).then((function(){localStorage.clear(),k({}),f(!1),y(!1),window.location="/"})).catch((function(e){return console.log(e)}))};return v?Object(j.jsx)("div",{children:Object(j.jsx)("h1",{children:Object(j.jsx)(L,{})})}):!p&&b?Object(j.jsx)("div",{className:"login",children:Object(j.jsx)(D,{emailLogin:function(){m(!1)}})}):p||b||a?p||b||!a?p&&!_.has_account?Object(j.jsx)("div",{className:"setup",children:Object(j.jsx)(d,{user:_})}):Object(j.jsx)(r.a,{children:Object(j.jsxs)("div",{className:"app",children:[Object(j.jsx)(l.a,{component:function(){return Object(j.jsx)(M,{user:_})}}),Object(j.jsxs)(l.c,{children:[Object(j.jsx)(l.a,{exact:!0,path:"/",component:function(){return Object(j.jsx)(P,{user:_})}}),Object(j.jsx)(l.a,{path:"/logout",component:function(){return Object(j.jsx)(J,{logout:w})}}),Object(j.jsx)(l.a,{exact:!0,path:"/u/:username",component:function(){return Object(j.jsx)(U,{user:_})}})]}),Object(j.jsx)(l.a,{component:function(){return Object(j.jsx)(I,{user:_})}})]})}):Object(j.jsx)("div",{className:"setup-email-password-account",children:Object(j.jsx)(Y,{cancelEmailLogin:C})}):Object(j.jsx)("div",{className:"email-login",children:Object(j.jsx)(q,{cancelEmailLogin:C,setupEmailLogin:function(){m(!1),s(!0)},loginUser:function(e){return fetch("/get-user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})}).then((function(e){return e.json()})).then((function(e){localStorage.setItem("user",JSON.stringify(e)),k(e),f(!0)}))}})})};o.a.render(Object(j.jsx)(a.a.StrictMode,{children:Object(j.jsx)(G,{})}),document.getElementById("root"))},66:function(e,t,n){},67:function(e,t,n){},72:function(e,t,n){},73:function(e,t,n){},74:function(e,t,n){},75:function(e,t,n){},91:function(e,t){}},[[120,1,2]]]);
//# sourceMappingURL=main.9ddd4b44.chunk.js.map